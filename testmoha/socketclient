import socket
import re

class Joueur:
    def __init__(self, num):
        self.num = num
        self.cartes = []

    def ajouter_carte(self, carte):
        self.cartes.append(carte)

    def afficher_deck(self):
        print(f"Joueur {self.num}: {self.cartes}")

HOST = "localhost"
PORT = 25425

joueurs = {}

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as client_socket:
    client_socket.connect((HOST, PORT))

    while True:
        data = client_socket.recv(1024)
        if not data:
            break

        # Utiliser une expression régulière pour extraire les informations
        player_data = re.findall(r"i\| (\d+)\|\[([^\]]+)\]", data.decode('utf-8'))
        for player_match in player_data:
            num = int(player_match[0])
            cartes_str = player_match[1]

            if num not in joueurs:
                joueurs[num] = Joueur(num)

            cartes = eval(f"[{cartes_str}]")
            for carte in cartes:
                joueurs[num].ajouter_carte(carte)

# Afficher les decks de tous les joueurs
joueurs[2].afficher_deck()
joueurs[3].afficher_deck()
